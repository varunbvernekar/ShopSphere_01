<!-- src/app/components/customer/payment/payment.html -->

<div class="payment-page">
  <header class="payment-header">
    <h1>Checkout</h1>
    <p>Complete your order by providing delivery address and payment details</p>
  </header>

  <div *ngIf="errorMessage" class="error-message">
    {{ errorMessage }}
  </div>

  <div class="payment-container">
    <!-- Order Summary -->
    <div class="order-summary-card">
      <h2>Order Summary</h2>
      
      <div class="order-items">
        <div *ngFor="let item of cartItems" class="order-item">
          <img [src]="item.product.previewImage" [alt]="item.product.name" class="item-image" />
          <div class="item-details">
            <h3>{{ item.product.name }}</h3>
            <p class="item-customization">
              {{ item.customization.color }} • {{ item.customization.size }} • {{ item.customization.material }}
            </p>
            <p class="item-quantity">Quantity: {{ item.quantity }}</p>
          </div>
          <div class="item-price">${{ (item.price * item.quantity).toFixed(2) }}</div>
        </div>
      </div>

      <div class="summary-totals">
        <div class="summary-row">
          <span>Subtotal</span>
          <span>${{ subtotal.toFixed(2) }}</span>
        </div>
        <div class="summary-row">
          <span>Tax (10%)</span>
          <span>${{ tax.toFixed(2) }}</span>
        </div>
        <div class="summary-row">
          <span>Shipping</span>
          <span>${{ shipping.toFixed(2) }}</span>
        </div>
        <div class="summary-row total">
          <span>Total</span>
          <span>${{ total.toFixed(2) }}</span>
        </div>
      </div>
    </div>

    <!-- Checkout Form -->
    <div class="checkout-form-card">
      <form (ngSubmit)="onSubmit()" class="checkout-form">
        <!-- Delivery Address Section -->
        <div class="form-section">
          <h2 class="section-title">Delivery Address</h2>
          
          <div class="form-group">
            <label for="street">Street Address *</label>
            <input
              id="street"
              type="text"
              [(ngModel)]="address.street"
              name="street"
              required
              placeholder="123 Main Street"
            />
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="city">City *</label>
              <input
                id="city"
                type="text"
                [(ngModel)]="address.city"
                name="city"
                required
                placeholder="New York"
              />
            </div>

            <div class="form-group">
              <label for="state">State/Province *</label>
              <input
                id="state"
                type="text"
                [(ngModel)]="address.state"
                name="state"
                required
                placeholder="NY"
              />
            </div>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="zipCode">Zip/Postal Code *</label>
              <input
                id="zipCode"
                type="text"
                [(ngModel)]="address.zipCode"
                name="zipCode"
                required
                placeholder="10001"
              />
            </div>

            <div class="form-group">
              <label for="country">Country *</label>
              <input
                id="country"
                type="text"
                [(ngModel)]="address.country"
                name="country"
                required
                placeholder="United States"
              />
            </div>
          </div>
        </div>

        <!-- Payment Method Section -->
        <div class="form-section">
          <h2 class="section-title">Payment Method</h2>
          
          <div class="form-group">
            <label for="paymentMethod">Payment Method *</label>
            <select id="paymentMethod" [(ngModel)]="paymentMethod" name="paymentMethod" required>
              <option value="card">Credit/Debit Card</option>
              <option value="paypal">PayPal</option>
              <option value="cod">Cash on Delivery</option>
            </select>
          </div>

          <div *ngIf="paymentMethod === 'card'" class="card-details">
            <div class="form-group">
              <label for="cardNumber">Card Number *</label>
              <input
                id="cardNumber"
                type="text"
                [(ngModel)]="cardNumber"
                name="cardNumber"
                placeholder="1234 5678 9012 3456"
                maxlength="19"
              />
            </div>

            <div class="form-group">
              <label for="cardName">Cardholder Name *</label>
              <input
                id="cardName"
                type="text"
                [(ngModel)]="cardName"
                name="cardName"
                placeholder="John Doe"
              />
            </div>

            <div class="form-row">
              <div class="form-group">
                <label for="cardExpiry">Expiry Date *</label>
                <input
                  id="cardExpiry"
                  type="text"
                  [(ngModel)]="cardExpiry"
                  name="cardExpiry"
                  placeholder="MM/YY"
                  maxlength="5"
                />
              </div>

              <div class="form-group">
                <label for="cardCvv">CVV *</label>
                <input
                  id="cardCvv"
                  type="text"
                  [(ngModel)]="cardCvv"
                  name="cardCvv"
                  placeholder="123"
                  maxlength="4"
                />
              </div>
            </div>
          </div>

          <div *ngIf="paymentMethod === 'paypal'" class="payment-info">
            <p>You will be redirected to PayPal to complete your payment.</p>
          </div>

          <div *ngIf="paymentMethod === 'cod'" class="payment-info">
            <p>You will pay cash when the order is delivered.</p>
          </div>
        </div>

        <div class="form-actions">
          <button type="button" class="btn-secondary" (click)="onCancel()" [disabled]="isLoading">
            Cancel
          </button>
          <button type="submit" class="btn-primary" [disabled]="isLoading">
            {{ isLoading ? 'Processing...' : 'Place Order' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

